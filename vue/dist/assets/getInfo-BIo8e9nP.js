import{_ as P,u as I,a as i,i as M,h as j,j as w,d as e,w as n,f as C,E as m,b as u,o as L,e as p,t as h,g as $}from"./index-ChxILKwA.js";const D={class:"user-list-container"},q={class:"search-box"},A={class:"user-list"},F={class:"pagination"},G={__name:"getInfo",setup(H){const f=I(),c=i([]),l=i(1),d=i(15),b=i(0),y=i(!1),_=i(""),g=async()=>{if(!y.value){y.value=!0;try{const t=await C.post("/api/legymCustomer/get_info",{manager:f.manager,pageSize:d.value,currentPage:l.value,searchUser:_.value});t.data.customer?(c.value=[t.data.customer],b.value=1):(c.value=t.data.customers,b.value=t.data.total,l.value=t.data.currentPage,d.value=t.data.pageSize)}catch(t){m.error(t.response.data.message)}finally{y.value=!1}}};M(()=>{g()});const z=t=>{d.value=t,g()},x=t=>{l.value=t,g()},S=async t=>{try{const a=await C.post("/api/legymCustomer/begin_state",{id:t.id,manager:f.manager,username:t.username});a.status===200&&(t.begin_state=a.data.begin_state,m.success(a.data.message))}catch(a){console.error("更新开始状态失败：",a),m.error("更新开始状态失败")}},B=async t=>{try{if(await $.confirm("确定要删除该用户吗？剩余乐点将返还。","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})==="confirm"){const v=await C.post("/api/legymCustomer/delete",{id:t.id,manager:f.manager,username:t.username});v.status===200&&(c.value=c.value.filter(r=>r.username!==t.username),m.success(v.data.message))}}catch(a){a!=="cancel"&&(console.error("删除用户失败：",a),m.error("删除用户失败"))}},V=()=>{l.value=1,g()},T=()=>{_.value="",l.value=1,g()};return(t,a)=>{const v=u("el-input"),r=u("el-button"),o=u("el-table-column"),k=u("el-tag"),U=u("el-table"),E=u("el-pagination");return L(),j("div",D,[w("div",q,[e(v,{modelValue:_.value,"onUpdate:modelValue":a[0]||(a[0]=s=>_.value=s),placeholder:"输入用户名搜索",class:"search-input"},null,8,["modelValue"]),e(r,{type:"primary",onClick:V},{default:n(()=>a[3]||(a[3]=[p("搜索")])),_:1}),e(r,{onClick:T},{default:n(()=>a[4]||(a[4]=[p("重置")])),_:1})]),w("div",A,[e(U,{data:c.value,stripe:""},{default:n(()=>[e(o,{prop:"manager",label:"管理员"}),e(o,{prop:"create_time",label:"创建时间",width:"170"}),e(o,{prop:"username",label:"用户名",width:"120"}),e(o,{prop:"password",label:"密码",width:"120"}),e(o,{prop:"schoolName",label:"学校"}),e(o,{prop:"runType",label:"跑步类型"}),e(o,{prop:"runTime",label:"跑步时间"}),e(o,{prop:"day_goals",label:"每日目标(km)"}),e(o,{prop:"day_in_week",label:"每周目标(天)"}),e(o,{prop:"complete_day_in_week",label:"已完成(天)"}),e(o,{prop:"total_goals",label:"总目标(km)"}),e(o,{prop:"complete_goals",label:"已完成(km)"}),e(o,{label:"跑步状态",width:"100"},{default:n(s=>[e(k,{type:s.row.is_run?"success":"info"},{default:n(()=>[p(h(s.row.is_run?"已完成":"未完成"),1)]),_:2},1032,["type"])]),_:1}),e(o,{label:"开始状态",width:"100"},{default:n(s=>[e(k,{type:s.row.begin_state?"success":"info"},{default:n(()=>[p(h(s.row.begin_state?"进行中":"暂停中"),1)]),_:2},1032,["type"])]),_:1}),e(o,{label:"操作",width:"150"},{default:n(s=>[e(r,{size:"small",type:s.row.begin_state?"warning":"success",onClick:N=>S(s.row)},{default:n(()=>[p(h(s.row.begin_state?"暂停":"开始"),1)]),_:2},1032,["type","onClick"]),e(r,{size:"small",type:"danger",onClick:N=>B(s.row)},{default:n(()=>a[5]||(a[5]=[p(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),w("div",F,[e(E,{"current-page":l.value,"onUpdate:currentPage":a[1]||(a[1]=s=>l.value=s),"page-size":d.value,"onUpdate:pageSize":a[2]||(a[2]=s=>d.value=s),"page-sizes":[15,30,50,100],total:b.value,onSizeChange:z,onCurrentChange:x,layout:"total, sizes, prev, pager, next, jumper"},null,8,["current-page","page-size","total"])])])])}}},K=P(G,[["__scopeId","data-v-12b12098"]]);export{K as default};
