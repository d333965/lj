import{_ as E,u as N,a as i,i as P,h as I,j as h,d as e,w as n,f as b,E as u,b as c,o as M,e as _,t as v,g as V}from"./index-CcubBSod.js";const j={class:"user-list-container"},L={class:"user-list"},U={class:"pagination"},$={__name:"getInfo",setup(D){const d=N(),p=i([]),l=i(1),r=i(15),w=i(0),m=i(!1),f=async()=>{if(!m.value){m.value=!0;try{const a=await b.post("/api/legymCustomer/get_info",{manager:d.manager,pageSize:r.value,currentPage:l.value});p.value=a.data.customers,w.value=a.data.total,l.value=a.data.currentPage,r.value=a.data.pageSize}catch(a){console.error("获取用户列表失败：",a),u.error("获取用户列表失败")}finally{m.value=!1}}};P(()=>{f()});const C=a=>{r.value=a,f()},z=a=>{l.value=a,f()},k=async a=>{try{const o=await b.post("/api/legymCustomer/begin_state",{id:a.id,manager:d.manager,username:a.username});o.status===200&&(a.begin_state=o.data.begin_state,u.success(o.data.message))}catch(o){console.error("更新开始状态失败：",o),u.error("更新开始状态失败")}},x=async a=>{try{if(await V.confirm("确定要删除该用户吗？剩余乐点将返还。","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})==="confirm"){const t=await b.post("/api/legymCustomer/delete",{id:a.id,manager:d.manager,username:a.username});t.status===200&&(p.value=p.value.filter(g=>g.username!==a.username),u.success(t.data.message))}}catch(o){o!=="cancel"&&(console.error("删除用户失败：",o),u.error("删除用户失败"))}};return(a,o)=>{const t=c("el-table-column"),g=c("el-tag"),y=c("el-button"),S=c("el-table"),B=c("el-pagination");return M(),I("div",j,[h("div",L,[e(S,{data:p.value,stripe:""},{default:n(()=>[e(t,{prop:"manager",label:"管理员"}),e(t,{prop:"create_time",label:"创建时间",width:"170"}),e(t,{prop:"username",label:"用户名",width:"120"}),e(t,{prop:"password",label:"密码",width:"120"}),e(t,{prop:"schoolName",label:"学校"}),e(t,{prop:"runType",label:"跑步类型"}),e(t,{prop:"runTime",label:"跑步时间"}),e(t,{prop:"day_goals",label:"每日目标(km)"}),e(t,{prop:"day_in_week",label:"每周目标(天)"}),e(t,{prop:"complete_day_in_week",label:"已完成(天)"}),e(t,{prop:"total_goals",label:"总目标(km)"}),e(t,{prop:"complete_goals",label:"已完成(km)"}),e(t,{label:"跑步状态",width:"100"},{default:n(s=>[e(g,{type:s.row.is_run?"success":"info"},{default:n(()=>[_(v(s.row.is_run?"已完成":"未完成"),1)]),_:2},1032,["type"])]),_:1}),e(t,{label:"开始状态",width:"100"},{default:n(s=>[e(g,{type:s.row.begin_state?"success":"info"},{default:n(()=>[_(v(s.row.begin_state?"进行中":"暂停中"),1)]),_:2},1032,["type"])]),_:1}),e(t,{label:"操作",width:"150"},{default:n(s=>[e(y,{size:"small",type:s.row.begin_state?"warning":"success",onClick:T=>k(s.row)},{default:n(()=>[_(v(s.row.begin_state?"暂停":"开始"),1)]),_:2},1032,["type","onClick"]),e(y,{size:"small",type:"danger",onClick:T=>x(s.row)},{default:n(()=>o[2]||(o[2]=[_(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),h("div",U,[e(B,{"current-page":l.value,"onUpdate:currentPage":o[0]||(o[0]=s=>l.value=s),"page-size":r.value,"onUpdate:pageSize":o[1]||(o[1]=s=>r.value=s),"page-sizes":[15,30,50,100],total:w.value,onSizeChange:C,onCurrentChange:z,layout:"total, sizes, prev, pager, next, jumper"},null,8,["current-page","page-size","total"])])])])}}},A=E($,[["__scopeId","data-v-f3909650"]]);export{A as default};
